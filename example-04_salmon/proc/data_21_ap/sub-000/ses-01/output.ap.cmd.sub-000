afni_proc.py -subj_id sub-000 -dsets /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/func/sub-000_ses-01_task-checkbrd_run-01_bold.nii.gz /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/func/sub-000_ses-01_task-checkbrd_run-02_bold.nii.gz -copy_anat /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/anat/sub-000_ses-01_run-01_T1w_ROT.nii.gz -anat_has_skull no -blocks despike tshift align volreg blur mask scale regress -tcat_remove_first_trs 3 -align_opts_aea -cost lpa+ZZ -pre_matrix /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/anat/mat_rot_anat.1D -volreg_align_to MIN_OUTLIER -volreg_align_e2a -volreg_warp_dxyz 2.0 -volreg_compute_tsnr yes -mask_epi_anat yes -blur_size 4.0 -regress_stim_times /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/func/stim_checkbrd.1D -regress_stim_labels checkbrd -regress_basis BLOCK(10,1) -regress_stim_times_offset -6.000000 -regress_compute_fitts -regress_make_ideal_sum sum_ideal.1D -regress_motion_per_run -regress_censor_motion 0.2 -regress_censor_outliers 0.05 -regress_est_blur_epits -regress_est_blur_errts -regress_run_clustsim no -html_review_style pythonic -execute
echo auto-generated by afni_proc.py, Mon Mar 10 17:06:00 2025
auto-generated by afni_proc.py, Mon Mar 10 17:06:00 2025
echo (version 7.85, January 29, 2025)
(version 7.85, January 29, 2025)
echo execution started: `date`
date
execution started: Mon Mar 10 17:06:02 EDT 2025
afni -ver
Precompiled binary linux_rocky_8: Feb 24 2025 (Version AFNI_25.0.07 'Severus Alexander')
afni_history -check_date 7 Mar 2024
-- is current: afni_history as new as: 07 Mar 2024
               most recent entry is:   24 Feb 2025
if ( 0 ) then
if ( 0 > 0 ) then
set subj = sub-000
endif
set output_dir = sub-000.results
if ( -d sub-000.results ) then
set runs = ( `count_afni -digits 2 1 2` )
count_afni -digits 2 1 2
mkdir -p sub-000.results
mkdir sub-000.results/stimuli
timing_tool.py -add_offset -6 -timing /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/func/stim_checkbrd.1D -write_timing sub-000.results/stimuli/offset_stim_checkbrd.1D
3dcopy /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/anat/sub-000_ses-01_run-01_T1w_ROT.nii.gz sub-000.results/sub-000_ses-01_run-01_T1w_ROT
++ 3dcopy: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
3dTcat -prefix sub-000.results/pb00.sub-000.r01.tcat /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/func/sub-000_ses-01_task-checkbrd_run-01_bold.nii.gz[3..$]
++ 3dTcat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ elapsed time = 2.7 s
3dTcat -prefix sub-000.results/pb00.sub-000.r02.tcat /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/func/sub-000_ses-01_task-checkbrd_run-02_bold.nii.gz[3..$]
++ 3dTcat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ elapsed time = 2.7 s
set tr_counts = ( 167 167 )
cd sub-000.results
find_variance_lines.tcsh -polort 3 -nerode 2 -rdir vlines.pb00.tcat pb00.sub-000.r01.tcat+orig.HEAD pb00.sub-000.r02.tcat+orig.HEAD
tee out.vlines.pb00.tcat.txt
++ have nslices : 37 37
++ params: min_cvox 7, nerode 2,
           perc 90, sdpower 2, thresh 0.97

++ copying pb00.sub-000.r01.tcat+orig.HEAD[0..$] to ts.0.orig.r01.nii.gz
++ 3dTcat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ elapsed time = 6.3 s
++ copying pb00.sub-000.r02.tcat+orig.HEAD[0..$] to ts.0.orig.r02.nii.gz
++ 3dTcat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ elapsed time = 6.2 s
++ creating automask from first dset
++ 3dAutomask: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Emperor Zhark
++ Loading dataset ts.0.orig.r01.nii.gz
++ Forming automask
 + Fixed clip level = 448.820160
 + Used gradual clip level = 356.543243 .. 617.920471
 + Number voxels above clip level = 29881
 + Clustering voxels ...
 + Largest cluster has 29241 voxels
 + Clustering voxels ...
 + Largest cluster has 10961 voxels
 + Filled   870 voxels in small holes; now have 11831 voxels
 + Filled    26 voxels in large holes; now have 11857 voxels
 + Clustering voxels ...
 + Largest cluster has 11828 voxels
 + Clustering non-brain voxels ...
 + Clustering voxels ...
 + Largest cluster has 169471 voxels
 + Mask now has 11829 voxels
++ 11829 voxels in the mask [out of 181300: 6.52%]
++ first  13 x-planes are zero [from R]
++ last   11 x-planes are zero [from L]
++ first   1 y-planes are zero [from P]
++ last   29 y-planes are zero [from A]
++ first   1 z-planes are zero [from I]
++ last    0 z-planes are zero [from S]
++ Output dataset ./mask.nii.gz
++ CPU time = 0.000000 sec

-- will apply mask mask.nii.gz
++ eroding mask.nii.gz by 2 voxels
++ no -frac option: defaulting to -union
++ processing 1 input dataset(s), NN=2...
++ padding all datasets by 0 (for dilations)
++ have 1 volumes of input to combine
++ frac 0 over 1 volumes gives min count 0
++ voxel limits: 0 clipped, 566 survived, 180734 were zero
++ writing result mask.nii.gz...
++ Output dataset ./mask.nii.gz

++ requiring 7 voxels in mask columns
++ 3dLocalstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Emperor Zhark
++ Number of voxels in mask = 566
++ Neighborhood comprises 75 voxels
++ Start sub-brick [0]
++ Output dataset ./tmp.mask.col.count.nii.gz
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
++ Output dataset ./mask.nii.gz

-- detrend -polort 3, new eset = ts.1.det.r01.nii.gz
++ 3dTproject: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Cox the Algebraic (Linear)
++ Setting up regressors
++ 1 Blocks * 4 polynomials -- 4 polort regressors
++ 167 retained time points MINUS 4 regressors ==> 163 D.O.F. left
++ no -mask option ==> processing all 181300 voxels in dataset
[7m*+ WARNING:[0m 3dTproject input data :: 4639 vectors are constant

++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
++ Output dataset ./tmp.stdev.nii.gz
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
++ Output dataset ./var.0.orig.r01.nii.gz
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
++ Output dataset ./var.1.scale.r01.nii.gz
++ 3dLocalstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Emperor Zhark
++ Number of voxels in mask = 23
++ Neighborhood comprises 75 voxels
++ Start sub-brick [0]
++ Output dataset ./proj.r01.nii.gz
++ Neighborhood definition (NN=3) accepted
++ User input stat threshold: -1
++ User input stat threshold: 0.97
++ Data volume:      [0] 'MEAN'
++ Threshold volume: [0] 'MEAN'
++ How many sides to this stat? 0
++ Looks like clustering is *not* being performed on a stat value; won't worry about sidedness, then.
++ Opt code: 2sided,-1,0.97,NN3
[7m*+ WARNING:[0m No mask being used? That *could* be OK, but thought I'd let you know...
++ Threshold volume [0] does *not* appear to be a stat!
[7m*+ WARNING:[0m No clusters found!
#** NO CLUSTERS FOUND ***
-- detrend -polort 3, new eset = ts.1.det.r02.nii.gz
++ 3dTproject: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Cox the Algebraic (Linear)
++ Setting up regressors
++ 1 Blocks * 4 polynomials -- 4 polort regressors
++ 167 retained time points MINUS 4 regressors ==> 163 D.O.F. left
++ no -mask option ==> processing all 181300 voxels in dataset
[7m*+ WARNING:[0m 3dTproject input data :: 4634 vectors are constant

++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
++ Output dataset ./tmp.stdev.nii.gz
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
++ Output dataset ./var.0.orig.r02.nii.gz
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
++ Output dataset ./var.1.scale.r02.nii.gz
++ 3dLocalstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Emperor Zhark
++ Number of voxels in mask = 23
++ Neighborhood comprises 75 voxels
++ Start sub-brick [0]
++ Output dataset ./proj.r02.nii.gz
++ Neighborhood definition (NN=3) accepted
++ User input stat threshold: -1
++ User input stat threshold: 0.97
++ Data volume:      [0] 'MEAN'
++ Threshold volume: [0] 'MEAN'
++ How many sides to this stat? 0
++ Looks like clustering is *not* being performed on a stat value; won't worry about sidedness, then.
++ Opt code: 2sided,-1,0.97,NN3
[7m*+ WARNING:[0m No mask being used? That *could* be OK, but thought I'd let you know...
++ Threshold volume [0] does *not* appear to be a stat!
[7m*+ WARNING:[0m No clusters found!
#** NO CLUSTERS FOUND ***

-- evaluating intersection...
++ 3dMean: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Neighborhood definition (NN=3) accepted
++ User input stat threshold: -1
++ User input stat threshold: 0.97
++ Data volume:      [0] 'MEAN'
++ Threshold volume: [0] 'MEAN'
++ How many sides to this stat? 0
++ Looks like clustering is *not* being performed on a stat value; won't worry about sidedness, then.
++ Opt code: 2sided,-1,0.97,NN3
[7m*+ WARNING:[0m No mask being used? That *could* be OK, but thought I'd let you know...
++ Threshold volume [0] does *not* appear to be a stat!
[7m*+ WARNING:[0m No clusters found!
#** NO CLUSTERS FOUND ***
++ Check about making images
++ have do_clean, removing time series...


== found questionable regions across inputs: 0 0
   found questionable intersected regions  : 0

=============== bad_coords.inter.txt ===============

=============== bad_coords.r01.txt ===============

=============== bad_coords.r02.txt ===============

touch out.pre_ss_warn.txt
foreach run ( 01 02 )
3dToutcount -automask -fraction -polort 3 -legendre pb00.sub-000.r01.tcat+orig
++ 3dToutcount: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ 11829 voxels passed mask/clip
1deval -a outcount.r01.1D -expr 1-step(a-0.05)
if ( `1deval -a outcount.r$run.1D"{0}" -expr "step(a-0.4)"` ) then
1deval -a outcount.r01.1D{0} -expr step(a-0.4)
end
3dToutcount -automask -fraction -polort 3 -legendre pb00.sub-000.r02.tcat+orig
++ 3dToutcount: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ 11901 voxels passed mask/clip
1deval -a outcount.r02.1D -expr 1-step(a-0.05)
if ( `1deval -a outcount.r$run.1D"{0}" -expr "step(a-0.4)"` ) then
1deval -a outcount.r02.1D{0} -expr step(a-0.4)
end
cat outcount.r01.1D outcount.r02.1D
cat rm.out.cen.r01.1D rm.out.cen.r02.1D
foreach run ( 01 02 )
3dTto1D -method 4095_warn -input pb00.sub-000.r01.tcat+orig
tee -a out.4095_all.txt
++ computing 4095_warn, nvox = 181300, nmask = 181300, nt = 167
++ global max = 3620.000000, global 4095 count = 0
++ max of 3620 is okay, clearing results...
end
3dTto1D -method 4095_warn -input pb00.sub-000.r02.tcat+orig
tee -a out.4095_all.txt
++ computing 4095_warn, nvox = 181300, nmask = 181300, nt = 167
++ global max = 3504.000000, global 4095 count = 0
++ max of 3504 is okay, clearing results...
end
awk /warning/ {print} out.4095_all.txt
tee out.4095_warn.txt
set minindex = `3dTstat -argmin -prefix - outcount_rall.1D\'`
3dTstat -argmin -prefix - outcount_rall.1D'
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
set ovals = ( `1d_tool.py -set_run_lengths $tr_counts                       
                          -index_to_run_tr $minindex` )
1d_tool.py -set_run_lengths 167 167 -index_to_run_tr 254
set minoutrun = 02
set minouttr = 87
echo min outlier: run 02, TR 87
tee out.min_outlier.txt
min outlier: run 02, TR 87
foreach run ( 01 02 )
3dDespike -NEW -nomask -prefix pb01.sub-000.r01.despike pb00.sub-000.r01.tcat+orig
++ 3dDespike: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RW Cox
++ Input dataset is in short format, but output will be in float format
++ ignoring first 0 time points, using last 167
++ using 167 time points => -corder 6
++ Loading dataset pb00.sub-000.r01.tcat+orig
++ processing all 181300 voxels in dataset
++ Processing time series with NEW model fit algorithm
++ smash edit thresholds: 3.1 .. 5.0 MADs
 +   [ 3.457% .. 0.072% of normal distribution]
 +   [ 8.839% .. 3.125% of Laplace distribution]
++ start OpenMP thread #0
++ start OpenMP thread #4
++ start OpenMP thread #5
++ start OpenMP thread #7
++ start OpenMP thread #2
++ start OpenMP thread #6
++ start OpenMP thread #3
++ start OpenMP thread #1
.............................................................................
++ Elapsed despike time =  891ms

++ FINAL: 29502387 data points, 935708 edits [3.172%], 51031 big edits [0.173%]
end
3dDespike -NEW -nomask -prefix pb01.sub-000.r02.despike pb00.sub-000.r02.tcat+orig
++ 3dDespike: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RW Cox
++ Input dataset is in short format, but output will be in float format
++ ignoring first 0 time points, using last 167
++ using 167 time points => -corder 6
++ Loading dataset pb00.sub-000.r02.tcat+orig
++ processing all 181300 voxels in dataset
++ Processing time series with NEW model fit algorithm
++ smash edit thresholds: 3.1 .. 5.0 MADs
 +   [ 3.457% .. 0.072% of normal distribution]
 +   [ 8.839% .. 3.125% of Laplace distribution]
++ start OpenMP thread #0
++ start OpenMP thread #4
++ start OpenMP thread #7
++ start OpenMP thread #1
++ start OpenMP thread #2
++ start OpenMP thread #3
++ start OpenMP thread #5
++ start OpenMP thread #6
.............................................................................
++ Elapsed despike time =  864ms

++ FINAL: 29503222 data points, 935222 edits [3.170%], 50445 big edits [0.171%]
end
foreach run ( 01 02 )
3dTshift -tzero 0 -quintic -prefix pb02.sub-000.r01.tshift pb01.sub-000.r01.despike+orig
++ 3dTshift: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
[7m*+ WARNING:[0m dataset is already aligned in time!
[7m*+ WARNING:[0m ==>> output dataset is just a copy of input dataset
end
3dTshift -tzero 0 -quintic -prefix pb02.sub-000.r02.tshift pb01.sub-000.r02.despike+orig
++ 3dTshift: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
[7m*+ WARNING:[0m dataset is already aligned in time!
[7m*+ WARNING:[0m ==>> output dataset is just a copy of input dataset
end
3dbucket -prefix vr_base_min_outlier pb02.sub-000.r02.tshift+orig[87]
++ 3dbucket: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
align_epi_anat.py -anat2epi -anat sub-000_ses-01_run-01_T1w_ROT+orig -suffix _al_junk -epi vr_base_min_outlier+orig -epi_base 0 -epi_strip 3dAutomask -anat_has_skull no -cost lpa+ZZ -pre_matrix /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/anat/mat_rot_anat.1D -volreg off -tshift off
#++ align_epi_anat version: 1.63
#++ turning off volume registration
#Script is running (command trimmed):
  3dAttribute DELTA ./vr_base_min_outlier+orig
#Script is running (command trimmed):
  3dAttribute DELTA ./vr_base_min_outlier+orig
#Script is running (command trimmed):
  3dAttribute DELTA ./sub-000_ses-01_run-01_T1w_ROT+orig
#++ Multi-cost is lpa+ZZ
#++ Removing all the temporary files
#Script is running:
  \rm -f ./__tt_vr_base_min_outlier*
#Script is running:
  \rm -f ./__tt_sub-000_ses-01_run-01_T1w_ROT*
#Script is running (command trimmed):
  3dcopy ./sub-000_ses-01_run-01_T1w_ROT+orig ./__tt_sub-000_ses-01_run-01_T1w_ROT+orig
++ 3dcopy: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
#Script is running (command trimmed):
  3dinfo ./__tt_sub-000_ses-01_run-01_T1w_ROT+orig | \grep 'Data Axes Tilt:'| \grep 'Oblique'
#++ Dataset /lscratch/50240498/sub-000_ses-01/sub-000.results/__tt_sub-000_ses-01_run-01_T1w_ROT+orig is not oblique
#Script is running (command trimmed):
  3dinfo ./vr_base_min_outlier+orig | \grep 'Data Axes Tilt:'| \grep 'Oblique'
#++ Dataset /lscratch/50240498/sub-000_ses-01/sub-000.results/vr_base_min_outlier+orig is not oblique
#Script is running (command trimmed):
  3dAttribute DELTA ./__tt_sub-000_ses-01_run-01_T1w_ROT+orig
#++ Spacing for anat to oblique epi alignment is 0.625000
#Script is running (command trimmed):
  3dWarp -verb -matvec_in2out /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/anat/mat_rot_anat.1D -prefix ./__tt_sub-000_ses-01_run-01_T1w_ROT_ob -newgrid 0.625000 ./__tt_sub-000_ses-01_run-01_T1w_ROT+orig 
++ 3dWarp: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RW Cox
#++ using 0th sub-brick because only one found
#Script is running (command trimmed):
  3dbucket -prefix ./__tt_vr_base_min_outlier_ts ./vr_base_min_outlier+orig'[0]'
++ 3dbucket: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
#++ resampling epi to match anat data
#Script is running (command trimmed):
  3dresample -master ./__tt_sub-000_ses-01_run-01_T1w_ROT_ob+orig -prefix ./__tt_vr_base_min_outlier_ts_rs -inset ./__tt_vr_base_min_outlier_ts+orig'' -rmode Cu
#++ removing skull or area outside brain
#Script is running (command trimmed):
  3dAutomask -apply_prefix ./__tt_vr_base_min_outlier_ts_rs_ns ./__tt_vr_base_min_outlier_ts_rs+orig
++ 3dAutomask: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Emperor Zhark
++ Loading dataset ./__tt_vr_base_min_outlier_ts_rs+orig
++ Forming automask
 + Fixed clip level = 401.226105
 + Used gradual clip level = 304.656494 .. 577.758545
 + Number voxels above clip level = 1415627
 + Clustering voxels ...
 + Largest cluster has 1410303 voxels
 + Clustering voxels ...
 + Largest cluster has 1397820 voxels
 + Filled 10423 voxels in small holes; now have 1408243 voxels
 + Filled 627142 voxels in large holes; now have 2035385 voxels
 + Clustering voxels ...
 + Largest cluster has 2035084 voxels
 + Clustering non-brain voxels ...
 + Clustering voxels ...
 + Largest cluster has 33240453 voxels
 + Mask now has 2061107 voxels
++ 2061107 voxels in the mask [out of 35301560: 5.84%]
++ first  91 x-planes are zero [from R]
++ last   93 x-planes are zero [from L]
++ first  61 y-planes are zero [from A]
++ last   47 y-planes are zero [from P]
++ first  93 z-planes are zero [from I]
++ last   91 z-planes are zero [from S]
++ applying mask to original data
++ Writing masked data
++ CPU time = 0.000000 sec
#++ Computing weight mask
#Script is running (command trimmed):
  3dBrickStat -automask -percentile 90.000000 1 90.000000 ./__tt_vr_base_min_outlier_ts_rs_ns+orig
#++ Applying threshold of 1330.184448 on /lscratch/50240498/sub-000_ses-01/sub-000.results/__tt_vr_base_min_outlier_ts_rs_ns+orig
#Script is running (command trimmed):
  3dcalc -datum float -prefix ./__tt_vr_base_min_outlier_ts_rs_ns_wt -a ./__tt_vr_base_min_outlier_ts_rs_ns+orig -expr 'min(1,(a/1330.184448))'
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
#++ Aligning anat data to epi data
#Script is running (command trimmed):
  3dAllineate -lpa+ZZ -wtprefix ./__tt_sub-000_ses-01_run-01_T1w_ROT_ob_al_junk_wtal -weight ./__tt_vr_base_min_outlier_ts_rs_ns_wt+orig -source ./__tt_sub-000_ses-01_run-01_T1w_ROT_ob+orig -prefix ./__tt_sub-000_ses-01_run-01_T1w_ROT_ob_temp_al_junk -base ./__tt_vr_base_min_outlier_ts_rs_ns+orig -nocmass -1Dmatrix_save ./sub-000_ses-01_run-01_T1w_ROT_al_junk_e2a_only_mat.aff12.1D -master SOURCE -weight_frac 1.0 -maxrot 6 -maxshf 10 -VERB -warp aff -source_automask+4 -onepass 
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
++ lpa+ parameters: hel=0.40 mi=0.00 nmi=0.20 crA=0.40 ov=0.40 [to be zeroed at Final iteration]
++ Option '-nocmass' disables center-of-mass usage
++ Source dataset: ./__tt_sub-000_ses-01_run-01_T1w_ROT_ob+orig.HEAD
++ Base dataset:   ./__tt_vr_base_min_outlier_ts_rs_ns+orig.HEAD
++ Loading datasets into memory
++ 2763586 voxels in -source_automask+4
++ Zero-pad: not needed (plenty of internal padding)
++ 2058216 voxels [5.8%] in weight mask
++ Number of points for matching = 2058216
++ Local correlation: blok type = 'TOHD(3.23562)'
++ lpa+ parameters: hel=0.40 mi=0.00 nmi=0.20 crA=0.40 ov=0.40 [to be zeroed at Final iteration]
++ base center of mass = 169.779 185.937 169.886 (index)
 + source center of mass = 169.352 170.004 164.974 (index)
 + source-target CM = -0.267 -9.958 -3.070 (xyz)
 +        -cmass x y z shifts =   -0.267   -9.958   -3.070
 +  shift search range is +/- =   68.614   61.993   66.407
 + Range param#4 [z-angle] = -6.000000 .. 6.000000  center = 0.000000
 + Range param#5 [x-angle] = -6.000000 .. 6.000000  center = 0.000000
 + Range param#6 [y-angle] = -6.000000 .. 6.000000  center = 0.000000
 + Range param#1 [x-shift] = -10.000000 .. 10.000000  center = 0.000000
 + Range param#2 [y-shift] = -10.000000 .. 10.000000  center = 0.000000
 + Range param#3 [z-shift] = -10.000000 .. 10.000000  center = 0.000000
 + 12 free parameters
++ Normalized (unitless) convergence radius = 0.0000275
++ Final parameter search ranges:
 +       x-shift =  -10.000 ..   10.000
 +       y-shift =  -10.000 ..   10.000
 +       z-shift =  -10.000 ..   10.000
 +       z-angle =   -6.000 ..    6.000
 +       x-angle =   -6.000 ..    6.000
 +       y-angle =   -6.000 ..    6.000
 +       x-scale =    0.711 ..    1.406
 +       y-scale =    0.711 ..    1.406
 +       z-scale =    0.711 ..    1.406
 +     y/x-shear =   -0.111 ..    0.111
 +     z/x-shear =   -0.111 ..    0.111
 +     z/y-shear =   -0.111 ..    0.111
++ OpenMP thread count = 8
++ ======= Allineation of 1 sub-bricks using Local Pearson Abs + Others =======
++ ========== sub-brick #0 ========== [total CPU to here=0.0 s]
++ *** Fine pass begins ***
 + * Enter alignment setup routine
 + - copying base image
 + - copying source image
 + - copying weight image
 + - using 2058216 points from base image [use_all=0]
 + * Exit alignment setup routine
 +  - histogram: source clip 0 .. 0; base clip 0 .. 0
 +  - versus source range 0 .. 1055.86; base range -191.27 .. 3479.84
 + 1915564 total points stored in 3693 'TOHD(3.23562)' bloks (0 duplicates)
 + - Initial  cost = 1.242915
 + - Initial fine Parameters = 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000 1.0000 1.0000 0.0000 0.0000 0.0000
***********************************************************************************************************************************
 + - Finalish cost = 0.763838 ; 504 funcs
 + - ini Finalish Parameters = -0.5976 2.0287 -0.5382 0.1154 0.7030 0.2860 0.9890 0.9527 0.9892 0.0053 -0.0009 0.0100
 +  - Set lpa+ parameters back to purity before Final iterations
 +  - histogram: source clip 0 .. 0; base clip 0 .. 0
 +  - versus source range 0 .. 1055.86; base range -191.27 .. 3479.84
**************************************************************
 + - Final    cost = 0.264434 ; 374 funcs
 + Final fine fit Parameters:
       x-shift= -0.5768   y-shift=  1.9400   z-shift= -0.4667  ...  enorm=  2.0770 mm
       z-angle=  0.1117   x-angle=  0.9919   y-angle=  0.2909  ...  total=  1.0400 deg
       x-scale=  0.9893   y-scale=  0.9743   z-scale=  0.9932  ...  vol3D=  0.9573=(0.9856)^3 [base bigger than source]
     y/x-shear=  0.0003 z/x-shear=  0.0029 z/y-shear=  0.0096
 + - Fine net CPU time = 0.0 s
++ Computing output image
++ image warp: parameters = -0.5768 1.9400 -0.4667 0.1117 0.9919 0.2909 0.9893 0.9743 0.9932 0.0003 0.0029 0.0096
++ Unloading unneeded data
++ Wrote -1Dmatrix_save ./sub-000_ses-01_run-01_T1w_ROT_al_junk_e2a_only_mat.aff12.1D
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 81.4
++ ###########################################################
++ #   PLEASE check results VISUALLY for alignment quality   #
++ ###########################################################
#Script is running (command trimmed):
  cat_matvec -ONELINE ./sub-000_ses-01_run-01_T1w_ROT_al_junk_e2a_only_mat.aff12.1D /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/anat/mat_rot_anat.1D -I > ./sub-000_ses-01_run-01_T1w_ROT_al_junk_mat.aff12.1D
#++ Combining anat to epi and oblique transformations
#Script is running (command trimmed):
  3dAllineate -base ./__tt_vr_base_min_outlier_ts_rs_ns+orig -1Dmatrix_apply ./sub-000_ses-01_run-01_T1w_ROT_al_junk_mat.aff12.1D -prefix ./sub-000_ses-01_run-01_T1w_ROT_al_junk -input ./__tt_sub-000_ses-01_run-01_T1w_ROT+orig -master SOURCE -weight_frac 1.0 -maxrot 6 -maxshf 10 -VERB -warp aff -source_automask+4 -onepass 
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
++ Source dataset: ./__tt_sub-000_ses-01_run-01_T1w_ROT+orig.HEAD
++ Base dataset:   ./__tt_vr_base_min_outlier_ts_rs_ns+orig.HEAD
++ Loading datasets into memory
++ NOTE: base and source coordinate systems have different handedness
 +       Orientations: base=Right handed (RAI); source=Left handed (RPI)
 +     - It is nothing to worry about: 3dAllineate aligns based on coordinates.
 +     - But it is always important to check the alignment visually to be sure.
++ base center of mass = 169.779 185.937 169.886 (index)
 + source center of mass = 127.817 112.401 51.943 (index)
 + source-target CM = 1.149 -10.242 0.071 (xyz)
 +        -cmass x y z shifts =    1.149  -10.242    0.071
 +  shift search range is +/- =   68.614   61.993   66.407
 + Range param#4 [z-angle] = -6.000000 .. 6.000000  center = 0.000000
 + Range param#5 [x-angle] = -6.000000 .. 6.000000  center = 0.000000
 + Range param#6 [y-angle] = -6.000000 .. 6.000000  center = 0.000000
 + Range param#1 [x-shift] = -10.000000 .. 10.000000  center = 0.000000
 + Range param#2 [y-shift] = -10.000000 .. 10.000000  center = 0.000000
 + Range param#3 [z-shift] = -10.000000 .. 10.000000  center = 0.000000
++ Final parameter search ranges:
 +       x-shift =  -10.000 ..   10.000
 +       y-shift =  -10.000 ..   10.000
 +       z-shift =  -10.000 ..   10.000
 +       z-angle =   -6.000 ..    6.000
 +       x-angle =   -6.000 ..    6.000
 +       y-angle =   -6.000 ..    6.000
 +       x-scale =    0.711 ..    1.406
 +       y-scale =    0.711 ..    1.406
 +       z-scale =    0.711 ..    1.406
 +     y/x-shear =   -0.111 ..    0.111
 +     z/x-shear =   -0.111 ..    0.111
 +     z/y-shear =   -0.111 ..    0.111
++ OpenMP thread count = 8
++ ========== Applying transformation to 1 sub-bricks ==========
++ ========== sub-brick #0 ========== [total CPU to here=0.0 s]
 + * Enter alignment setup routine
 + - copying base image
 + - copying source image
 + - no weight image
 + - using 11 points from base image [use_all=0]
 + * Exit alignment setup routine
++ using -1Dmatrix_apply
++ Computing output image
++ image warp: parameters = -0.5545 0.0595 -1.3161 255.8479 0.2960 0.9203 -0.2241 -20.0775 0.4775 -0.1962 -0.5390 40.6699
++ Unloading unneeded data
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 2.1
++ ###########################################################
#++ Creating final output: anat data aligned to epi
# copy is not necessary
#++ Saving history
#Script is running (command trimmed):
  3dNotes -h "align_epi_anat.py -anat2epi -anat \
 sub-000_ses-01_run-01_T1w_ROT+orig -suffix _al_junk -epi \
 vr_base_min_outlier+orig -epi_base 0 -epi_strip 3dAutomask \
 -anat_has_skull no -cost lpa+ZZ -pre_matrix \
 /data/NIMH_SSCC/p022_dead_salmon/data_00_basic/sub-000/ses-01/anat/mat_rot_anat.1D \
 -volreg off -tshift off" \
 ./sub-000_ses-01_run-01_T1w_ROT_al_junk+orig

#++ Removing all the temporary files
#Script is running:
  \rm -f ./__tt_vr_base_min_outlier*
#Script is running:
  \rm -f ./__tt_sub-000_ses-01_run-01_T1w_ROT*

# Finished alignment successfully

foreach run ( 01 02 )
3dvolreg -verbose -zpad 1 -base vr_base_min_outlier+orig -1Dfile dfile.r01.1D -prefix rm.epi.volreg.r01 -cubic -1Dmatrix_save mat.r01.vr.aff12.1D pb02.sub-000.r01.tshift+orig
++ 3dvolreg: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RW Cox
++ Reading in base dataset ./vr_base_min_outlier+orig.BRIK
++ Reading input dataset ./pb02.sub-000.r01.tshift+orig.BRIK
++ Edging: x=4 y=4 z=2
++ Creating mask for -maxdisp
 + Automask has 37344 voxels
 + 14469 voxels left in -maxdisp mask after erosion
++ Initializing alignment base
++ edt_blur: sigx 6, dx 2, fwhm 14.1289, sfac 2.5, firx 8
++ Starting final pass on 167 sub-bricks: 0..1..2..3..4..5..6..7..8..9..10..11..12..13..14..15..16..17..18..19..20..21..22..23..24..25..26..27..28..29..30..31..32..33..34..35..36..37..38..39..40..41..42..43..44..45..46..47..48..49..50..51..52..53..54..55..56..57..58..59..60..61..62..63..64..65..66..67..68..69..70..71..72..73..74..75..76..77..78..79..80..81..82..83..84..85..86..87..88..89..90..91..92..93..94..95..96..97..98..99..100..101..102..103..104..105..106..107..108..109..110..111..112..113..114..115..116..117..118..119..120..121..122..123..124..125..126..127..128..129..130..131..132..133..134..135..136..137..138..139..140..141..142..143..144..145..146..147..148..149..150..151..152..153..154..155..156..157..158..159..160..161..162..163..164..165..166..
++ CPU time for realignment=0 s  [=0 s/sub-brick]
++ Min : roll=+0.020  pitch=-0.093  yaw=-0.035  dS=-0.047  dL=-0.024  dP=+0.250
++ Mean: roll=+0.029  pitch=-0.077  yaw=-0.024  dS=-0.040  dL=-0.016  dP=+0.260
++ Max : roll=+0.041  pitch=-0.056  yaw=-0.015  dS=-0.035  dL=-0.002  dP=+0.282
++ Max displacements (mm) for each sub-brick:
 0.33(0.00) 0.33(0.01) 0.34(0.01) 0.34(0.01) 0.34(0.01) 0.34(0.01) 0.34(0.01) 0.33(0.00) 0.33(0.01) 0.33(0.00) 0.33(0.01) 0.34(0.01) 0.34(0.01) 0.33(0.00) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.02) 0.33(0.02) 0.33(0.01) 0.33(0.00) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.33(0.01) 0.32(0.00) 0.33(0.00) 0.32(0.01) 0.32(0.01) 0.32(0.00) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.00) 0.33(0.01) 0.33(0.00) 0.33(0.01) 0.33(0.00) 0.33(0.01) 0.33(0.01) 0.33(0.02) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.32(0.01) 0.33(0.01) 0.32(0.01) 0.33(0.01) 0.32(0.00) 0.32(0.00) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.33(0.01) 0.32(0.02) 0.33(0.01) 0.33(0.02) 0.34(0.01) 0.33(0.01) 0.33(0.01) 0.34(0.01) 0.34(0.00) 0.33(0.01) 0.33(0.00) 0.32(0.01) 0.32(0.00) 0.32(0.01) 0.32(0.01) 0.33(0.02) 0.32(0.01) 0.33(0.01) 0.33(0.00) 0.33(0.02) 0.33(0.01) 0.33(0.01) 0.33(0.00) 0.33(0.00) 0.33(0.01) 0.32(0.01) 0.33(0.01) 0.33(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.34(0.01) 0.33(0.01) 0.33(0.01) 0.34(0.01) 0.33(0.01) 0.33(0.01) 0.34(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.32(0.01) 0.33(0.01) 0.33(0.00) 0.32(0.01) 0.32(0.01) 0.32(0.00) 0.32(0.00) 0.33(0.01) 0.33(0.00) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.32(0.01) 0.33(0.00) 0.32(0.01) 0.33(0.01) 0.32(0.01) 0.33(0.01) 0.32(0.01) 0.33(0.01) 0.33(0.00) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.00) 0.33(0.01) 0.34(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.34(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01) 0.32(0.01) 0.33(0.01) 0.33(0.01) 0.33(0.01)
++ Max displacement in automask = 0.34 (mm) at sub-brick 4
++ Max delta displ  in automask = 0.02 (mm) at sub-brick 45
++ Wrote dataset to disk in ./rm.epi.volreg.r01+orig.BRIK
3dcalc -overwrite -a pb02.sub-000.r01.tshift+orig -expr 1 -prefix rm.epi.all1
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
[7m*+ WARNING:[0m input 'a' is not used in the expression
cat_matvec -ONELINE sub-000_ses-01_run-01_T1w_ROT_al_junk_mat.aff12.1D -I mat.r01.vr.aff12.1D
3dAllineate -base sub-000_ses-01_run-01_T1w_ROT+orig -input pb02.sub-000.r01.tshift+orig -1Dmatrix_apply mat.r01.warp.aff12.1D -mast_dxyz 2 -prefix rm.epi.nomask.r01
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
++ Source dataset: ./pb02.sub-000.r01.tshift+orig.HEAD
++ Base dataset:   ./sub-000_ses-01_run-01_T1w_ROT+orig.HEAD
++ Loading datasets into memory
 +        -cmass x y z shifts =   -0.757    7.881   -0.488
 +  shift search range is +/- =   51.159   51.159   31.779
++ master dataset for output = base
++ changing output grid spacing to 2.0000 mm
++ OpenMP thread count = 8
++ ========== Applying transformation to 167 sub-bricks ==========
volume 0..1..2..3..4..5..6..7..8..9..10..11..12..13..14..15..16..17..18..19..20..21..22..23..24..25..26..27..28..29..30..31..32..33..34..35..36..37..38..39..40..41..42..43..44..45..46..47..48..49..50..51..52..53..54..55..56..57..58..59..60..61..62..63..64..65..66..67..68..69..70..71..72..73..74..75..76..77..78..79..80..81..82..83..84..85..86..87..88..89..90..91..92..93..94..95..96..97..98..99..100..101..102..103..104..105..106..107..108..109..110..111..112..113..114..115..116..117..118..119..120..121..122..123..124..125..126..127..128..129..130..131..132..133..134..135..136..137..138..139..140..141..142..143..144..145..146..147..148..149..150..151..152..153..154..155..156..157..158..159..160..161..162..163..164..165..166
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 11.9
++ ###########################################################
3dAllineate -base sub-000_ses-01_run-01_T1w_ROT+orig -input rm.epi.all1+orig -1Dmatrix_apply mat.r01.warp.aff12.1D -mast_dxyz 2 -final NN -quiet -prefix rm.epi.1.r01
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
[7m*+ WARNING:[0m center of mass shifts (-cmass) are turned off, but would be large
[7m*+ WARNING:[0m   - at least one is more than 20% of search range
 +        -cmass x y z shifts =   -0.198  -10.349   -2.443
 +  shift search range is +/- =   51.159   51.159   31.779
 +                                  0.4%    20.2%     7.7%
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 6.9
 +  
++ ***********************************************************
[7m*+ WARNING:[0m -cmass was turned off, but might have been needed :(
 +           Please check your results - PLEASE PLEASE PLEASE
++ ***********************************************************
3dTstat -min -prefix rm.epi.min.r01 rm.epi.1.r01+orig
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
end
3dvolreg -verbose -zpad 1 -base vr_base_min_outlier+orig -1Dfile dfile.r02.1D -prefix rm.epi.volreg.r02 -cubic -1Dmatrix_save mat.r02.vr.aff12.1D pb02.sub-000.r02.tshift+orig
++ 3dvolreg: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RW Cox
++ Reading in base dataset ./vr_base_min_outlier+orig.BRIK
++ Reading input dataset ./pb02.sub-000.r02.tshift+orig.BRIK
++ Edging: x=4 y=4 z=2
++ Creating mask for -maxdisp
 + Automask has 35705 voxels
 + 13462 voxels left in -maxdisp mask after erosion
++ Initializing alignment base
++ edt_blur: sigx 6, dx 2, fwhm 14.1289, sfac 2.5, firx 8
++ Starting final pass on 167 sub-bricks: 0..1..2..3..4..5..6..7..8..9..10..11..12..13..14..15..16..17..18..19..20..21..22..23..24..25..26..27..28..29..30..31..32..33..34..35..36..37..38..39..40..41..42..43..44..45..46..47..48..49..50..51..52..53..54..55..56..57..58..59..60..61..62..63..64..65..66..67..68..69..70..71..72..73..74..75..76..77..78..79..80..81..82..83..84..85..86..87..88..89..90..91..92..93..94..95..96..97..98..99..100..101..102..103..104..105..106..107..108..109..110..111..112..113..114..115..116..117..118..119..120..121..122..123..124..125..126..127..128..129..130..131..132..133..134..135..136..137..138..139..140..141..142..143..144..145..146..147..148..149..150..151..152..153..154..155..156..157..158..159..160..161..162..163..164..165..166..
++ CPU time for realignment=0 s  [=0 s/sub-brick]
++ Min : roll=-0.006  pitch=-0.015  yaw=-0.019  dS=-0.005  dL=-0.003  dP=-0.012
++ Mean: roll=+0.004  pitch=+0.000  yaw=-0.003  dS=+0.001  dL=+0.004  dP=+0.003
++ Max : roll=+0.016  pitch=+0.013  yaw=+0.007  dS=+0.008  dL=+0.016  dP=+0.025
++ Max displacements (mm) for each sub-brick:
 0.06(0.00) 0.05(0.01) 0.05(0.01) 0.04(0.01) 0.04(0.01) 0.05(0.01) 0.04(0.01) 0.04(0.01) 0.04(0.01) 0.04(0.01) 0.04(0.01) 0.04(0.01) 0.04(0.01) 0.04(0.00) 0.04(0.01) 0.04(0.01) 0.03(0.01) 0.04(0.01) 0.03(0.01) 0.03(0.00) 0.03(0.01) 0.04(0.01) 0.03(0.01) 0.04(0.01) 0.03(0.01) 0.04(0.01) 0.03(0.02) 0.03(0.01) 0.03(0.00) 0.02(0.01) 0.03(0.02) 0.03(0.01) 0.03(0.00) 0.03(0.01) 0.02(0.01) 0.03(0.01) 0.03(0.01) 0.03(0.01) 0.03(0.01) 0.03(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.03(0.01) 0.02(0.01) 0.03(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.00) 0.03(0.00) 0.02(0.01) 0.02(0.00) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.00) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.02) 0.02(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.01(0.02) 0.01(0.01) 0.02(0.02) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.03(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.02) 0.02(0.01) 0.01(0.01) 0.02(0.00) 0.01(0.01) 0.02(0.01) 0.00(0.02) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.00) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.00(0.01) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.01(0.02) 0.01(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.00) 0.01(0.00) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.00) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.01(0.00) 0.01(0.00) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.00) 0.01(0.00) 0.01(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.00) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.00) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.01) 0.02(0.01) 0.02(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.01(0.01) 0.02(0.01)
++ Max displacement in automask = 0.06 (mm) at sub-brick 0
++ Max delta displ  in automask = 0.02 (mm) at sub-brick 87
++ Wrote dataset to disk in ./rm.epi.volreg.r02+orig.BRIK
3dcalc -overwrite -a pb02.sub-000.r02.tshift+orig -expr 1 -prefix rm.epi.all1
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
[7m*+ WARNING:[0m input 'a' is not used in the expression
cat_matvec -ONELINE sub-000_ses-01_run-01_T1w_ROT_al_junk_mat.aff12.1D -I mat.r02.vr.aff12.1D
3dAllineate -base sub-000_ses-01_run-01_T1w_ROT+orig -input pb02.sub-000.r02.tshift+orig -1Dmatrix_apply mat.r02.warp.aff12.1D -mast_dxyz 2 -prefix rm.epi.nomask.r02
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
++ Source dataset: ./pb02.sub-000.r02.tshift+orig.HEAD
++ Base dataset:   ./sub-000_ses-01_run-01_T1w_ROT+orig.HEAD
++ Loading datasets into memory
 +        -cmass x y z shifts =   -0.771    8.021   -0.517
 +  shift search range is +/- =   51.159   51.159   31.779
++ master dataset for output = base
++ changing output grid spacing to 2.0000 mm
++ OpenMP thread count = 8
++ ========== Applying transformation to 167 sub-bricks ==========
volume 0..1..2..3..4..5..6..7..8..9..10..11..12..13..14..15..16..17..18..19..20..21..22..23..24..25..26..27..28..29..30..31..32..33..34..35..36..37..38..39..40..41..42..43..44..45..46..47..48..49..50..51..52..53..54..55..56..57..58..59..60..61..62..63..64..65..66..67..68..69..70..71..72..73..74..75..76..77..78..79..80..81..82..83..84..85..86..87..88..89..90..91..92..93..94..95..96..97..98..99..100..101..102..103..104..105..106..107..108..109..110..111..112..113..114..115..116..117..118..119..120..121..122..123..124..125..126..127..128..129..130..131..132..133..134..135..136..137..138..139..140..141..142..143..144..145..146..147..148..149..150..151..152..153..154..155..156..157..158..159..160..161..162..163..164..165..166
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 11.7
++ ###########################################################
3dAllineate -base sub-000_ses-01_run-01_T1w_ROT+orig -input rm.epi.all1+orig -1Dmatrix_apply mat.r02.warp.aff12.1D -mast_dxyz 2 -final NN -quiet -prefix rm.epi.1.r02
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
[7m*+ WARNING:[0m center of mass shifts (-cmass) are turned off, but would be large
[7m*+ WARNING:[0m   - at least one is more than 20% of search range
 +        -cmass x y z shifts =   -0.198  -10.349   -2.443
 +  shift search range is +/- =   51.159   51.159   31.779
 +                                  0.4%    20.2%     7.7%
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 7.6
 +  
++ ***********************************************************
[7m*+ WARNING:[0m -cmass was turned off, but might have been needed :(
 +           Please check your results - PLEASE PLEASE PLEASE
++ ***********************************************************
3dTstat -min -prefix rm.epi.min.r02 rm.epi.1.r02+orig
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
end
cat dfile.r01.1D dfile.r02.1D
3dMean -datum short -prefix rm.epi.mean rm.epi.min.r01+orig.HEAD rm.epi.min.r02+orig.HEAD
++ 3dMean: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
3dcalc -a rm.epi.mean+orig -expr step(a-0.999) -prefix mask_epi_extents
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
foreach run ( 01 02 )
3dcalc -a rm.epi.nomask.r01+orig -b mask_epi_extents+orig -expr a*b -prefix pb03.sub-000.r01.volreg
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
end
3dcalc -a rm.epi.nomask.r02+orig -b mask_epi_extents+orig -expr a*b -prefix pb03.sub-000.r02.volreg
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
end
cat_matvec -ONELINE sub-000_ses-01_run-01_T1w_ROT_al_junk_mat.aff12.1D -I
3dAllineate -base sub-000_ses-01_run-01_T1w_ROT+orig -input vr_base_min_outlier+orig -1Dmatrix_apply mat.basewarp.aff12.1D -mast_dxyz 2 -prefix final_epi_vr_base_min_outlier
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
++ Source dataset: ./vr_base_min_outlier+orig.HEAD
++ Base dataset:   ./sub-000_ses-01_run-01_T1w_ROT+orig.HEAD
++ Loading datasets into memory
 +        -cmass x y z shifts =   -0.764    7.942   -0.498
 +  shift search range is +/- =   51.159   51.159   31.779
++ master dataset for output = base
++ changing output grid spacing to 2.0000 mm
++ OpenMP thread count = 8
++ ========== Applying transformation to 1 sub-bricks ==========
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 0.2
++ ###########################################################
3dcopy sub-000_ses-01_run-01_T1w_ROT+orig anat_final.sub-000
++ 3dcopy: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
3dAllineate -base final_epi_vr_base_min_outlier+orig -allcostX -input anat_final.sub-000+orig
tee out.allcostX.txt
++ 3dAllineate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Zhark the Registrator
++ Source dataset: ./anat_final.sub-000+orig.HEAD
++ Base dataset:   ./final_epi_vr_base_min_outlier+orig.HEAD
++ Loading datasets into memory
++ Local correlation: blok type = 'TOHD(10.354)'
 +        -cmass x y z shifts =    2.388   -9.260   -1.248
 +  shift search range is +/- =   50.718   57.138   44.298
[7m*+ WARNING:[0m No output dataset will be calculated
++ OpenMP thread count = 8
 + initial Parameters = 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000 1.0000 1.0000 0.0000 0.0000 0.0000
++ allcost output: init #0
   ls   = 0.153549
   sp   = 0.117306
   mi   = 4.30737
   crM  = 0.0589293
   nmi  = 0.84217
   je   = 4.30737
   hel  = -0.1722
   crA  = 0.245115
   crU  = 0.211171
   lss  = 0.846451
   lpc  = 0.97406
   lpa  = 0.0259395
   lpc+ = 1.07322
   lpa+ = 0.125101
++ 3dAllineate: total CPU time = 0.0 sec  Elapsed = 2.2
++ ###########################################################
3dTstat -mean -prefix rm.signal.vreg.r01 pb03.sub-000.r01.volreg+orig
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
3dDetrend -polort 3 -prefix rm.noise.det -overwrite pb03.sub-000.r01.volreg+orig
++ 3dDetrend: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
3dTstat -stdev -prefix rm.noise.vreg.r01 rm.noise.det+orig
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
3dcalc -a rm.signal.vreg.r01+orig -b rm.noise.vreg.r01+orig -c mask_epi_extents+orig -expr c*a/b -prefix TSNR.vreg.r01.sub-000
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
foreach run ( 01 02 )
3dmerge -1blur_fwhm 4.0 -doall -prefix pb04.sub-000.r01.blur pb03.sub-000.r01.volreg+orig
++ 3dmerge: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ default -1dindex = 0
++ default -1tindex = 1
Program 3dmerge 
3dmerge: edit and combine 3D datasets, by RW Cox
++ editing input dataset in memory (203.9 MB)
++ edt_blur: sigx 1.69864, dx 2, fwhm 4, sfac 2.5, firx 3
.......................................................................................................................................................................
-- Wrote edited dataset: ./pb04.sub-000.r01.blur+orig.BRIK

end
3dmerge -1blur_fwhm 4.0 -doall -prefix pb04.sub-000.r02.blur pb03.sub-000.r02.volreg+orig
++ 3dmerge: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ default -1dindex = 0
++ default -1tindex = 1
Program 3dmerge 
3dmerge: edit and combine 3D datasets, by RW Cox
++ editing input dataset in memory (203.9 MB)
++ edt_blur: sigx 1.69864, dx 2, fwhm 4, sfac 2.5, firx 3
.......................................................................................................................................................................
-- Wrote edited dataset: ./pb04.sub-000.r02.blur+orig.BRIK

end
foreach run ( 01 02 )
3dAutomask -prefix rm.mask_r01 pb04.sub-000.r01.blur+orig
++ 3dAutomask: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Emperor Zhark
++ Loading dataset pb04.sub-000.r01.blur+orig
++ Forming automask
 + Fixed clip level = 288.197266
 + Used gradual clip level = 226.092697 .. 396.497345
 + Number voxels above clip level = 59042
 + Clustering voxels ...
 + Largest cluster has 59041 voxels
 + Clustering voxels ...
 + Largest cluster has 58355 voxels
 + Filled  1375 voxels in small holes; now have 59730 voxels
 + Filled    50 voxels in large holes; now have 59780 voxels
 + Clustering voxels ...
 + Largest cluster has 59754 voxels
 + Clustering non-brain voxels ...
 + Clustering voxels ...
 + Largest cluster has 260133 voxels
 + Mask now has 59867 voxels
++ 59867 voxels in the mask [out of 320000: 18.71%]
++ first  14 x-planes are zero [from R]
++ last   16 x-planes are zero [from L]
++ first   4 y-planes are zero [from P]
++ last    9 y-planes are zero [from A]
++ first   0 z-planes are zero [from I]
++ last    0 z-planes are zero [from S]
++ CPU time = 0.000000 sec
end
3dAutomask -prefix rm.mask_r02 pb04.sub-000.r02.blur+orig
++ 3dAutomask: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Emperor Zhark
++ Loading dataset pb04.sub-000.r02.blur+orig
++ Forming automask
 + Fixed clip level = 293.042175
 + Used gradual clip level = 229.351425 .. 401.278656
 + Number voxels above clip level = 58678
 + Clustering voxels ...
 + Largest cluster has 58676 voxels
 + Clustering voxels ...
 + Largest cluster has 57986 voxels
 + Filled  1382 voxels in small holes; now have 59368 voxels
 + Filled    49 voxels in large holes; now have 59417 voxels
 + Clustering voxels ...
 + Largest cluster has 59395 voxels
 + Clustering non-brain voxels ...
 + Clustering voxels ...
 + Largest cluster has 260498 voxels
 + Mask now has 59502 voxels
++ 59502 voxels in the mask [out of 320000: 18.59%]
++ first  14 x-planes are zero [from R]
++ last   17 x-planes are zero [from L]
++ first   4 y-planes are zero [from P]
++ last   10 y-planes are zero [from A]
++ first   0 z-planes are zero [from I]
++ last    0 z-planes are zero [from S]
++ CPU time = 0.000000 sec
end
3dmask_tool -inputs rm.mask_r01+orig.HEAD rm.mask_r02+orig.HEAD -union -prefix full_mask.sub-000
++ processing 2 input dataset(s), NN=2...
++ padding all datasets by 0 (for dilations)
++ have 2 volumes of input to combine
++ frac 0 over 2 volumes gives min count 0
++ voxel limits: 0 clipped, 60244 survived, 259756 were zero
++ writing result full_mask.sub-000...
3dresample -master full_mask.sub-000+orig -input sub-000_ses-01_run-01_T1w_ROT+orig -prefix rm.resam.anat
3dmask_tool -dilate_input 5 -5 -fill_holes -input rm.resam.anat+orig -prefix mask_anat.sub-000
++ no -frac option: defaulting to -union
++ processing 1 input dataset(s), NN=2...
++ padding all datasets by 5 (for dilations)
++ have 1 volumes of input to combine
++ frac 0 over 1 volumes gives min count 0
++ voxel limits: 0 clipped, 209143 survived, 110857 were zero
++ filled 0 holes (0 voxels)
++ writing result mask_anat.sub-000...
3dmask_tool -input full_mask.sub-000+orig mask_anat.sub-000+orig -inter -prefix mask_epi_anat.sub-000
++ processing 2 input dataset(s), NN=2...
++ padding all datasets by 0 (for dilations)
++ have 2 volumes of input to combine
++ frac 1 over 2 volumes gives min count 2
++ voxel limits: 148899 clipped, 60244 survived, 110857 were zero
++ writing result mask_epi_anat.sub-000...
3dABoverlap -no_automask full_mask.sub-000+orig mask_anat.sub-000+orig
tee out.mask_ae_overlap.txt
++ 3dABoverlap: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
#A=./full_mask.sub-000+orig.BRIK  B=./mask_anat.sub-000+orig.BRIK
#A           #B           #(A uni B)   #(A int B)   #(A \ B)     #(B \ A)     %(A \ B)    %(B \ A)    Rx(B/A)    Ry(B/A)    Rz(B/A)
60244        209143       209143       60244        0            148899        0.0000     71.1948     2.6400     2.4393     1.4947
3ddot -dodice full_mask.sub-000+orig mask_anat.sub-000+orig
tee out.mask_ae_dice.txt
0.447267	
foreach run ( 01 02 )
3dTstat -prefix rm.mean_r01 pb04.sub-000.r01.blur+orig
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
3dcalc -a pb04.sub-000.r01.blur+orig -b rm.mean_r01+orig -c mask_epi_extents+orig -expr c * min(200, a/b*100)*step(a)*step(b) -prefix pb05.sub-000.r01.scale
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
end
3dTstat -prefix rm.mean_r02 pb04.sub-000.r02.blur+orig
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
3dcalc -a pb04.sub-000.r02.blur+orig -b rm.mean_r02+orig -c mask_epi_extents+orig -expr c * min(200, a/b*100)*step(a)*step(b) -prefix pb05.sub-000.r02.scale
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
end
1d_tool.py -infile dfile_rall.1D -set_nruns 2 -demean -write motion_demean.1D
1d_tool.py -infile dfile_rall.1D -set_nruns 2 -derivative -demean -write motion_deriv.1D
1d_tool.py -infile motion_demean.1D -set_nruns 2 -split_into_pad_runs mot_demean
1d_tool.py -infile dfile_rall.1D -set_nruns 2 -show_censor_count -censor_prev_TR -censor_motion 0.2 motion_sub-000
total number of censored TRs (simple form) = 0
1deval -a motion_sub-000_censor.1D -b outcount_sub-000_censor.1D -expr a*b
1d_tool.py -infile censor_sub-000_combined_2.1D -show_trs_uncensored space
set ktrs = 1dcat out.keep_trs_rall.txt
3dDeconvolve -input pb05.sub-000.r01.scale+orig.HEAD pb05.sub-000.r02.scale+orig.HEAD -censor censor_sub-000_combined_2.1D -ortvec mot_demean.r01.1D mot_demean_r01 -ortvec mot_demean.r02.1D mot_demean_r02 -polort 3 -num_stimts 1 -stim_times 1 stimuli/offset_stim_checkbrd.1D BLOCK(10,1) -stim_label 1 checkbrd -fout -tout -x1D X.xmat.1D -xjpeg X.jpg -x1D_uncensored X.nocensor.xmat.1D -errts errts.sub-000 -bucket stats.sub-000
++ 3dDeconvolve extending num_stimts from 1 to 13 due to -ortvec
++ 3dDeconvolve: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: B. Douglas Ward, et al.
++ loading dataset pb05.sub-000.r01.scale+orig.HEAD pb05.sub-000.r02.scale+orig.HEAD
++ Auto-catenated input datasets treated as multiple imaging runs
++ Auto-catenated datasets start at:  0 167
++ STAT automask has 175520 voxels (out of 320000 = 54.8%)
++ Skipping check for initial transients
++ Input polort=3; Longest run=334.0 s; Recommended minimum polort=3 ++ OK ++
++ -stim_times using TR=2 s for stimulus timing conversion
++ -stim_times using TR=2 s for any -iresp output datasets
++  [you can alter the -iresp TR via the -TR_times option]
++ ** -stim_times NOTE ** guessing GLOBAL times if 1 time per line; LOCAL otherwise
++ ** GUESSED ** -stim_times 1 using LOCAL times
++ Number of time points: 334 (no censoring)
 + Number of parameters:  21 [20 baseline ; 1 signal]
++ Memory required for output bricks = 432,640,000 bytes (about 433 million)
++ Wrote matrix image to file X.jpg
++ Wrote matrix values to file X.xmat.1D
++ ========= Things you can do with the matrix file =========
++ (a) Linear regression with ARMA(1,1) modeling of serial correlation:

3dREMLfit -matrix X.xmat.1D \
 -input "pb05.sub-000.r01.scale+orig.HEAD pb05.sub-000.r02.scale+orig.HEAD" \
 -fout -tout -Rbuck stats.sub-000_REML -Rvar stats.sub-000_REMLvar \
 -Rerrts errts.sub-000_REML -verb
 
++ N.B.: 3dREMLfit command above written to file stats.REML_cmd
++ (b) Visualization/analysis of the matrix via ExamineXmat.R
++ (c) Synthesis of sub-model datasets using 3dSynthesize
++ ==========================================================
++ Wrote matrix values to file X.nocensor.xmat.1D
++ ----- Signal+Baseline matrix condition [X] (334x21):  4.03582  ++ VERY GOOD ++
++ ----- Signal-only matrix condition [X] (334x1):  1  ++ VERY GOOD ++
++ ----- Baseline-only matrix condition [X] (334x20):  4.03021  ++ VERY GOOD ++
++ ----- stim_base-only matrix condition [X] (334x12):  3.28229  ++ VERY GOOD ++
++ ----- polort-only matrix condition [X] (334x8):  1.01368  ++ VERY GOOD ++
++ +++++ Matrix inverse average error = 2.2225e-14  ++ VERY GOOD ++
++ Matrix setup time = 0.66 s
++ Calculations starting; elapsed time=5.243
++ voxel loop:0123456789.0123456789.0123456789.0123456789.0123456789.
++ Calculations finished; elapsed time=27.613
[7m*+ WARNING:[0m Smallest FDR q [0 Full_Fstat] = 0.994857 ==> few true single voxel detections
[7m*+ WARNING:[0m Smallest FDR q [2 checkbrd#0_Tstat] = 0.997364 ==> few true single voxel detections
[7m*+ WARNING:[0m Smallest FDR q [3 checkbrd_Fstat] = 0.994857 ==> few true single voxel detections
++ Wrote bucket dataset into ./stats.sub-000+orig.BRIK
 + created 3 FDR curves in bucket header
++ Wrote 3D+time dataset into ./errts.sub-000+orig.BRIK
++ #Flops=1.32001e+11  Average Dot Product=37.8588
if ( 0 != 0 ) then
1d_tool.py -show_cormat_warnings -infile X.xmat.1D
tee out.cormat_warn.txt
-- no warnings for correlation matrix (cut = 0.400) --
1d_tool.py -show_df_info -infile X.xmat.1D
tee out.df_info.txt

initial DF                   : 334 : 100.0%

DF used for regs of interest :   1 :   0.3%
DF used for censoring        :   0 :   0.0%
DF used for polort           :   8 :   2.4%
DF used for motion           :  12 :   3.6%
total DF used                :  21 :   6.3%

final DF                     : 313 :  93.7%

3dTcat -prefix all_runs.sub-000 pb05.sub-000.r01.scale+orig.HEAD pb05.sub-000.r02.scale+orig.HEAD
++ 3dTcat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ elapsed time = 10.6 s
3dTstat -mean -prefix rm.signal.all all_runs.sub-000+orig[1dcat out.keep_trs_rall.txt]
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
3dTstat -stdev -prefix rm.noise.all errts.sub-000+orig[1dcat out.keep_trs_rall.txt]
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
3dcalc -a rm.signal.all+orig -b rm.noise.all+orig -expr a/b -prefix TSNR.sub-000
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
compute_ROI_stats.tcsh -out_dir tsnr_stats_regress -stats_file tsnr_stats_regress/stats_auto_brain.txt -dset_ROI mask_epi_anat.sub-000+orig -dset_data TSNR.sub-000+orig -rset_label brain -rval_list 1
++ writing stats text to tsnr_stats_regress/stats_auto_brain.txt

dset: brain (mask_epi_anat.sub-000), Nroi: 1
--------------------------------------------

   ROI   Nvox  Nzer  Dvox   Tmin  T25%  Tmed  T75%  Tmax     X      Y      Z    ROI_name
   ---   ----  ----  ----   ----  ----  ----  ----  ----   -----  -----  -----  --------
     1  60244    15   9.1     17    65    88   124   317    18.8   23.4   19.2  NONE

3dTnorm -norm2 -prefix rm.errts.unit errts.sub-000+orig
++ 3dTnorm: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RW Cox
3dmaskave -quiet -mask mask_epi_anat.sub-000+orig rm.errts.unit+orig
++ 3dmaskave: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
+++ 60244 voxels survive the mask
3dTstat -sos -prefix - mean.errts.unit.1D'
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
echo -- GCOR = `cat out.gcor.1D`
cat out.gcor.1D
-- GCOR =  0.000501278
3dmaskave -quiet -mask mask_epi_anat.sub-000+orig errts.sub-000+orig
++ 3dmaskave: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
+++ 60244 voxels survive the mask
3dTcorr1D -prefix corr_brain errts.sub-000+orig mean.errts.1D
++ 3dTcorr1D: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
 + reading dataset file errts.sub-000+orig
 + reading 1D file mean.errts.1D
 + loading dataset ./errts.sub-000+orig.BRIK into memory
++ Start correlations: 320000 voxels X 1 time series(334); 1 threads
[7m*+ WARNING:[0m THD_Tcorr1D: 144389 voxels skipped because were constant in time
++ Wrote dataset: ./corr_brain+orig.BRIK
3dcalc -a all_runs.sub-000+orig -b errts.sub-000+orig -expr a-b -prefix fitts.sub-000
++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
1dcat X.nocensor.xmat.1D[8]
1d_tool.py -infile X.nocensor.xmat.1D -write_xstim X.stim.xmat.1D
3dTstat -sum -prefix sum_ideal.1D X.stim.xmat.1D
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
[7m*+ WARNING:[0m Input dataset has 1 sub-brick ==> -tdiff is turned off
++ Output dataset ./sum_ideal.1D
touch blur_est.sub-000.1D
mkdir files_ACF
touch blur.epits.1D
foreach run ( 01 02 )
set trs = `1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded 
                          -show_trs_run $run`
1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded -show_trs_run 01
if ( 0..166 ==  ) continue
3dFWHMx -detrend -mask mask_epi_anat.sub-000+orig -ACF files_ACF/out.3dFWHMx.ACF.epits.r01.1D all_runs.sub-000+orig[0..166]
++ 3dFWHMx: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: The Bob
++ Number of voxels in mask = 60244
[7m*+ WARNING:[0m removed 15 voxels from mask because they are constant in time
++ detrending start: 13 baseline funcs, 167 time points
 + detrending done (0.00 CPU s thus far)
++ start ACF calculations out to radius = 13.22 mm
 + ACF done (0.00 CPU s thus far)
++ ACF 1D file [radius ACF mixed_model gaussian_NEWmodel] written to files_ACF/out.3dFWHMx.ACF.epits.r01.1D
++ 1dplot: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RWC et al.
 + and 1dplot-ed to file files_ACF/out.3dFWHMx.ACF.epits.r01.1D.png
end
set trs = `1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded 
                          -show_trs_run $run`
1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded -show_trs_run 02
if ( 167..333 ==  ) continue
3dFWHMx -detrend -mask mask_epi_anat.sub-000+orig -ACF files_ACF/out.3dFWHMx.ACF.epits.r02.1D all_runs.sub-000+orig[167..333]
++ 3dFWHMx: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: The Bob
++ Number of voxels in mask = 60244
[7m*+ WARNING:[0m removed 15 voxels from mask because they are constant in time
++ detrending start: 13 baseline funcs, 167 time points
 + detrending done (0.00 CPU s thus far)
++ start ACF calculations out to radius = 13.23 mm
 + ACF done (0.00 CPU s thus far)
++ ACF 1D file [radius ACF mixed_model gaussian_NEWmodel] written to files_ACF/out.3dFWHMx.ACF.epits.r02.1D
++ 1dplot: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RWC et al.
 + and 1dplot-ed to file files_ACF/out.3dFWHMx.ACF.epits.r02.1D.png
end
set blurs = ( `3dTstat -mean -prefix - blur.epits.1D'{0..$(2)}'\'` )
3dTstat -mean -prefix - blur.epits.1D{0..$(2)}'
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
echo average epits FWHM blurs: 0 0 0 0
average epits FWHM blurs: 0 0 0 0
echo 0 0 0 0   # epits FWHM blur estimates
set blurs = ( `3dTstat -mean -prefix - blur.epits.1D'{1..$(2)}'\'` )
3dTstat -mean -prefix - blur.epits.1D{1..$(2)}'
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
echo average epits ACF blurs: 0.993989 2.64884 1.81151 6.22399
average epits ACF blurs: 0.993989 2.64884 1.81151 6.22399
echo 0.993989 2.64884 1.81151 6.22399   # epits ACF blur estimates
touch blur.errts.1D
foreach run ( 01 02 )
set trs = `1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded 
                          -show_trs_run $run`
1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded -show_trs_run 01
if ( 0..166 ==  ) continue
3dFWHMx -detrend -mask mask_epi_anat.sub-000+orig -ACF files_ACF/out.3dFWHMx.ACF.errts.r01.1D errts.sub-000+orig[0..166]
++ 3dFWHMx: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: The Bob
++ Number of voxels in mask = 60244
[7m*+ WARNING:[0m removed 15 voxels from mask because they are constant in time
++ detrending start: 13 baseline funcs, 167 time points
 + detrending done (0.00 CPU s thus far)
++ start ACF calculations out to radius = 13.22 mm
 + ACF done (0.00 CPU s thus far)
++ ACF 1D file [radius ACF mixed_model gaussian_NEWmodel] written to files_ACF/out.3dFWHMx.ACF.errts.r01.1D
++ 1dplot: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RWC et al.
 + and 1dplot-ed to file files_ACF/out.3dFWHMx.ACF.errts.r01.1D.png
end
set trs = `1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded 
                          -show_trs_run $run`
1d_tool.py -infile X.xmat.1D -show_trs_uncensored encoded -show_trs_run 02
if ( 167..333 ==  ) continue
3dFWHMx -detrend -mask mask_epi_anat.sub-000+orig -ACF files_ACF/out.3dFWHMx.ACF.errts.r02.1D errts.sub-000+orig[167..333]
++ 3dFWHMx: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: The Bob
++ Number of voxels in mask = 60244
[7m*+ WARNING:[0m removed 15 voxels from mask because they are constant in time
++ detrending start: 13 baseline funcs, 167 time points
 + detrending done (0.00 CPU s thus far)
++ start ACF calculations out to radius = 13.22 mm
 + ACF done (0.00 CPU s thus far)
++ ACF 1D file [radius ACF mixed_model gaussian_NEWmodel] written to files_ACF/out.3dFWHMx.ACF.errts.r02.1D
++ 1dplot: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: RWC et al.
 + and 1dplot-ed to file files_ACF/out.3dFWHMx.ACF.errts.r02.1D.png
end
set blurs = ( `3dTstat -mean -prefix - blur.errts.1D'{0..$(2)}'\'` )
3dTstat -mean -prefix - blur.errts.1D{0..$(2)}'
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
echo average errts FWHM blurs: 0 0 0 0
average errts FWHM blurs: 0 0 0 0
echo 0 0 0 0   # errts FWHM blur estimates
set blurs = ( `3dTstat -mean -prefix - blur.errts.1D'{1..$(2)}'\'` )
3dTstat -mean -prefix - blur.errts.1D{1..$(2)}'
++ 3dTstat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: KR Hammett & RW Cox
echo average errts ACF blurs: 0.993981 2.64721 2.18811 6.2235
average errts ACF blurs: 0.993981 2.64721 2.18811 6.2235
echo 0.993981 2.64721 2.18811 6.2235   # errts ACF blur estimates
@radial_correlate -nfirst 0 -polort 3 -do_clean yes -rdir radcor.pb06.regress -mask mask_epi_anat.sub-000+orig all_runs.sub-000+orig.HEAD errts.sub-000+orig.HEAD
++ 3dTcat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ elapsed time = 10.7 s
++ 3dTcat: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ elapsed time = 10.5 s
++ 3dcopy: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
-- radcor: detrend -polort 3, new eset = det.d01
++ 3dTproject: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Cox the Algebraic (Linear)
++ Setting up regressors
++ 1 Blocks * 4 polynomials -- 4 polort regressors
++ 334 retained time points MINUS 4 regressors ==> 330 D.O.F. left
++ no -mask option ==> processing all 320000 voxels in dataset
[7m*+ WARNING:[0m 3dTproject input data :: 144389 vectors are constant

-- radcor: running correlation on dataset all_runs.sub-000+orig.HEAD ...

++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
++ radcor: merge blur: rad 20, FWHM 40
++ 3dmerge: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ default -1dindex = 0
++ default -1tindex = 1
Program 3dmerge 
3dmerge: edit and combine 3D datasets, by RW Cox
++ editing input dataset in memory (407.7 MB)
++ edt_blur: sigx 16.9864, dx 2, fwhm 40, sfac 2.5, firx 22
..............................................................................................................................................................................................................................................................................................................................................
-- Wrote edited dataset: ./sphere.mean.20.d01+orig.BRIK

++ 3dTcorrelate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Wrote dataset: ./radcor.20.d01.all_runs.corr+orig.BRIK
++ 3dbucket: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
---- radcor: done

-- radcor: detrend -polort 3, new eset = det.d02
++ 3dTproject: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: Cox the Algebraic (Linear)
++ Setting up regressors
++ 1 Blocks * 4 polynomials -- 4 polort regressors
++ 334 retained time points MINUS 4 regressors ==> 330 D.O.F. left
++ no -mask option ==> processing all 320000 voxels in dataset
[7m*+ WARNING:[0m 3dTproject input data :: 144389 vectors are constant

-- radcor: running correlation on dataset errts.sub-000+orig.HEAD ...

++ 3dcalc: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Authored by: A cast of thousands
++ radcor: merge blur: rad 20, FWHM 40
++ 3dmerge: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ default -1dindex = 0
++ default -1tindex = 1
Program 3dmerge 
3dmerge: edit and combine 3D datasets, by RW Cox
++ editing input dataset in memory (407.7 MB)
++ edt_blur: sigx 16.9864, dx 2, fwhm 40, sfac 2.5, firx 22
..............................................................................................................................................................................................................................................................................................................................................
-- Wrote edited dataset: ./sphere.mean.20.d02+orig.BRIK

++ 3dTcorrelate: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
++ Wrote dataset: ./radcor.20.d02.errts.corr+orig.BRIK
++ 3dbucket: AFNI version=AFNI_25.0.07 (Feb 24 2025) [64-bit]
---- radcor: done

++ have do_clean, cleaning up...

gen_epi_review.py -script @epi_review.sub-000 -dsets pb00.sub-000.r01.tcat+orig.HEAD pb00.sub-000.r02.tcat+orig.HEAD
cat
cat out.ap_uvars.txt
afni_python_wrapper.py -eval data_file_to_json()
gen_ss_review_scripts.py -exit0 -init_uvars_json out.ap_uvars.json -write_uvars_json out.ss_review_uvars.json
++ writing ss review basic:          @ss_review_basic
++ writing ss review driver:         @ss_review_driver
++ writing ss review drive commands: @ss_review_driver_commands
rm -f rm.epi.1.r01+orig.BRIK.gz rm.epi.1.r01+orig.HEAD rm.epi.1.r02+orig.BRIK.gz rm.epi.1.r02+orig.HEAD rm.epi.all1+orig.BRIK.gz rm.epi.all1+orig.HEAD rm.epi.mean+orig.BRIK.gz rm.epi.mean+orig.HEAD rm.epi.min.r01+orig.BRIK.gz rm.epi.min.r01+orig.HEAD rm.epi.min.r02+orig.BRIK.gz rm.epi.min.r02+orig.HEAD rm.epi.nomask.r01+orig.BRIK.gz rm.epi.nomask.r01+orig.HEAD rm.epi.nomask.r02+orig.BRIK.gz rm.epi.nomask.r02+orig.HEAD rm.epi.volreg.r01+orig.BRIK.gz rm.epi.volreg.r01+orig.HEAD rm.epi.volreg.r02+orig.BRIK.gz rm.epi.volreg.r02+orig.HEAD rm.errts.unit+orig.BRIK.gz rm.errts.unit+orig.HEAD rm.mask_r01+orig.BRIK.gz rm.mask_r01+orig.HEAD rm.mask_r02+orig.BRIK.gz rm.mask_r02+orig.HEAD rm.mean_r01+orig.BRIK.gz rm.mean_r01+orig.HEAD rm.mean_r02+orig.BRIK.gz rm.mean_r02+orig.HEAD rm.noise.all+orig.BRIK.gz rm.noise.all+orig.HEAD rm.noise.det+orig.BRIK.gz rm.noise.det+orig.HEAD rm.noise.vreg.r01+orig.BRIK.gz rm.noise.vreg.r01+orig.HEAD rm.out.cen.r01.1D rm.out.cen.r02.1D rm.resam.anat+orig.BRIK.gz rm.resam.anat+orig.HEAD rm.signal.all+orig.BRIK.gz rm.signal.all+orig.HEAD rm.signal.vreg.r01+orig.BRIK.gz rm.signal.vreg.r01+orig.HEAD
if ( -e @ss_review_basic ) then
./@ss_review_basic
tee out.ss_review.sub-000.txt

subject ID                : sub-000
AFNI version              : AFNI_25.0.07
AFNI package              : linux_rocky_8
TR                        : 2.0
TRs removed (per run)     : 3
multiband level           : 1
slice timing pattern      : simult
num stim classes provided : 1
final anatomy dset        : anat_final.sub-000+orig.HEAD
final stats dset          : stats.sub-000+orig.HEAD
orig voxel counts         : 70	70	37
orig voxel resolution     : 2.000000	2.000000	2.500000
orig volume center        : 1.822998	-14.525002	-1.828899
final voxel resolution    : 2.000000	2.000000	2.000000

motion limit              : 0.2
num TRs above mot limit   : 0
average motion (per TR)   : 0.00612541
average censored motion   : 0.00612541
max motion displacement   : 0.306209
max censored displacement : 0.306209
outlier limit             : 0.05
average outlier frac (TR) : 0.000663442
num TRs above out limit   : 0

num runs found            : 2
num TRs per run           : 167 167
num TRs per run (applied) : 167 167
num TRs per run (censored): 0 0
fraction censored per run : 0 0
TRs total (uncensored)    : 334
TRs total                 : 334
degrees of freedom used   : 21
degrees of freedom left   : 313
final DF fraction         : 0.937126

TRs censored              : 0
censor fraction           : 0.000000
num regs of interest      : 1
num TRs per stim (orig)   : 240
num TRs censored per stim : 0
fraction TRs censored     : 0.000
ave mot per sresp (orig)  : 0.006049
ave mot per sresp (cens)  : 0.006049

TSNR average              : 99.2113
global correlation (GCOR) : 0.000501278
anat/EPI mask Dice coef   : 0.447267
maximum F-stat (masked)   : 15.5032
blur estimates (ACF)      : 0.993981 2.64721 2.18811
blur estimates (FWHM)     : 0 0 0

apqc_make_tcsh.py -review_style pythonic -subj_dir . -uvar_json out.ss_review_uvars.json
++ Done making (executable) IC errts script: 
      run_instacorr_errts.tcsh
++ Done making (executable) GV errts script: 
      run_graphview_errts.tcsh
++ Done making (executable) IC pbrun script: 
      run_instacorr_pbrun.tcsh
++ Done making (executable) GV pbrun script: 
      run_graphview_pbrun.tcsh
++ APQC create: qc_00_vorig_EPI
++ APQC create: qc_01_vorig_anat
++ APQC create: qc_02_vorig_olap
++ APQC create: qc_03_ve2a_epi2anat
++ APQC create: qc_04_ve2a_mask2final
++ Found 2 stats items to use for vstat QC block
++ APQC create: qc_05_vstat_Full_Fstat
++ APQC create: qc_06_vstat_checkbrd_0_Coef
++ APQC create: qc_07_mot_enormoutlr
++ APQC create: qc_08_mot_VR6
++ APQC create: qc_09_mot_grayplot
++ APQC create: qc_10_regr_ideal
++ APQC create: qc_11_regr_stims
++ APQC create: qc_12_regr_df
++ APQC create: qc_13_regr_corr_errts
++ APQC create: qc_14_regr_tsnr_vreg
++ APQC create: qc_15_regr_tsnr_fin
++ APQC create: qc_16_radcor_rc_regress
                run: d02/1
++ APQC create: qc_17_warns_xmat
++ APQC create: qc_18_warns_cen_total
++ APQC create: qc_19_warns_cen_stim
++ APQC create: qc_20_warns_decon
++ APQC create: qc_21_warns_press
++ APQC create: qc_22_warns_sat_4095
++ APQC create: qc_23_warns_vlines
++ APQC create: qc_24_qsumm_ssrev
++ APQC create: copy jsons to info dir
++ APQC create: copy ss_review_basic file
++ APQC create: display ss_review_basic info

subject ID                : sub-000
AFNI version              : AFNI_25.0.07
AFNI package              : linux_rocky_8
TR                        : 2.0
TRs removed (per run)     : 3
multiband level           : 1
slice timing pattern      : simult
num stim classes provided : 1
final anatomy dset        : anat_final.sub-000+orig.HEAD
final stats dset          : stats.sub-000+orig.HEAD
orig voxel counts         : 70	70	37
orig voxel resolution     : 2.000000	2.000000	2.500000
orig volume center        : 1.822998	-14.525002	-1.828899
final voxel resolution    : 2.000000	2.000000	2.000000

motion limit              : 0.2
num TRs above mot limit   : 0
average motion (per TR)   : 0.00612541
average censored motion   : 0.00612541
max motion displacement   : 0.306209
max censored displacement : 0.306209
outlier limit             : 0.05
average outlier frac (TR) : 0.000663442
num TRs above out limit   : 0

num runs found            : 2
num TRs per run           : 167 167
num TRs per run (applied) : 167 167
num TRs per run (censored): 0 0
fraction censored per run : 0 0
TRs total (uncensored)    : 334
TRs total                 : 334
degrees of freedom used   : 21
degrees of freedom left   : 313
final DF fraction         : 0.937126

TRs censored              : 0
censor fraction           : 0.000000
num regs of interest      : 1
num TRs per stim (orig)   : 240
num TRs censored per stim : 0
fraction TRs censored     : 0.000
ave mot per sresp (orig)  : 0.006049
ave mot per sresp (cens)  : 0.006049

TSNR average              : 99.2113
global correlation (GCOR) : 0.000501278
anat/EPI mask Dice coef   : 0.447267
maximum F-stat (masked)   : 15.5032
blur estimates (ACF)      : 0.993981 2.64721 2.18811
blur estimates (FWHM)     : 0 0 0


# ++++++++++++++ Check output of @ss_review_basic ++++++++++++++ #
------------------------------------------------------------------
------------------------------------------------------------------

++ Done setting up QC dir: QC_sub-000
   To create the APQC HTML, run either this (from any location):      
     
       apqc_make_html.py -qc_dir /lscratch/50240498/sub-000_ses-01/sub-000.results/QC_sub-000

   ... or this (from the afni_proc.py results directory):

       apqc_make_html.py -qc_dir QC_sub-000


apqc_make_html.py -qc_dir QC_sub-000

++ Done! Wrote QC HTML.
   To view, run either this (without server):

       afni_open -b /lscratch/50240498/sub-000_ses-01/sub-000.results/QC_sub-000/index.html

   ... or this (with server):

       open_apqc.py -infiles /lscratch/50240498/sub-000_ses-01/sub-000.results/QC_sub-000/index.html


echo \nconsider running: \n

consider running: 

echo    afni_open -b sub-000.results/QC_sub-000/index.html
   afni_open -b sub-000.results/QC_sub-000/index.html
echo 

endif
cd ..
echo execution finished: `date`
date
execution finished: Mon Mar 10 17:18:25 EDT 2025
-- applying input view as +orig
** warning: removing first 3 TRs from beginning of each run
   --> the stimulus timing files must reflect the removal of these TRs
-- will use min outlier volume as motion base
-- including default: -radial_correlate_blocks regress
-- including default: -find_var_line_blocks tcat
-- tcat: reps is now 167
++ updating polort to 3, from run len 334.0 s
-- volreg: using base dset vr_base_min_outlier+orig
++ volreg: applying volreg/epi2anat xforms to isotropic 2 mm voxels
++ mask: using epi_anat mask in place of EPI one
-- have 1 ROI dict entries ...
++ will compute regress TSNR stats for dsets: brain
-- using default: will not apply EPI Automask
   (see 'MASKING NOTE' from the -help for details)

--> script is file: proc.sub-000

    to execute via tcsh:
         tcsh -xef proc.sub-000 |& tee output.proc.sub-000

    to execute via bash:
         tcsh -xef proc.sub-000 2>&1 | tee output.proc.sub-000

